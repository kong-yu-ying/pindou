<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>拼豆色号查找工具 - 带颜色显示</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e6ed;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        h1 i {
            color: #3498db;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
        }
        
        .search-section {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }
        
        .search-container {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
            position: relative;
        }
        
        .search-input-wrapper {
            flex: 1;
            min-width: 250px;
            position: relative;
        }
        
        .search-input {
            width: 100%;
            padding: 15px 45px 15px 20px;
            border: 2px solid #e0e6ed;
            border-radius: 10px;
            font-size: 1.1rem;
            transition: all 0.3s;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .clear-search {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #999;
            font-size: 1.2rem;
            cursor: pointer;
            display: none;
        }
        
        .clear-search:hover {
            color: #e74c3c;
        }
        
        .search-btn {
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 15px 30px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .search-btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(52, 152, 219, 0.3);
        }
        
        .example {
            margin-top: 15px;
            color: #7f8c8d;
            font-size: 0.95rem;
        }
        
        .example span {
            background-color: #f8f9fa;
            padding: 3px 8px;
            border-radius: 5px;
            margin: 0 5px;
            font-family: monospace;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .example span:hover {
            background-color: #e8f4fc;
        }
        
        .history-section {
            background-color: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
            display: none;
        }
        
        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e0e6ed;
        }
        
        .history-title {
            color: #2c3e50;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .clear-history {
            background-color: #f8f9fa;
            color: #7f8c8d;
            border: none;
            border-radius: 6px;
            padding: 8px 15px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .clear-history:hover {
            background-color: #f1f3f4;
            color: #e74c3c;
        }
        
        .history-items {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .history-item {
            background-color: #f8f9fa;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 1px solid #e0e6ed;
        }
        
        .history-item:hover {
            background-color: #e8f4fc;
            border-color: #3498db;
            transform: translateY(-2px);
        }
        
        .history-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
        }
        
        .results-section {
            display: none;
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }
        
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e0e6ed;
        }
        
        .result-title {
            color: #2c3e50;
            font-size: 1.5rem;
        }
        
        .result-color {
            font-weight: bold;
            color: #3498db;
        }
        
        /* 优化后的结果信息区域 */
        .result-info {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 25px;
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            align-items: center;
            justify-content: space-between;
        }
        
        .info-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 120px;
            padding: 15px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            flex: 1;
        }
        
        .info-label {
            color: #7f8c8d;
            font-size: 0.9rem;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .info-value {
            color: #2c3e50;
            font-size: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .color-preview {
            width: 100%;
            height: 60px;
            border-radius: 8px;
            margin-top: 10px;
            border: 1px solid #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #333;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
        }
        
        .visualization-section {
            margin-top: 20px;
        }
        
        .box-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 40px;
        }
        
        .box-title {
            font-size: 1.8rem;
            color: #2c3e50;
            margin-bottom: 15px;
            padding: 10px 20px;
            background-color: #ecf0f1;
            border-radius: 8px;
            width: fit-content;
        }
        
        .box-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
            margin-bottom: 10px;
        }
        
        .cell {
            width: 80px;
            height: 80px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s;
            position: relative;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            padding: 5px;
        }
        
        .empty-cell {
            background-color: #f5f5f5;
            color: #bbb;
            border: 2px dashed #ddd;
        }
        
        .filled-cell {
            color: #333;
            border: 2px solid rgba(0, 0, 0, 0.1);
        }
        
        .target-cell {
            border: 3px solid #27ae60;
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.4);
            z-index: 2;
        }
        
        .cell-hex {
            font-size: 0.7rem;
            margin-top: 3px;
            background: rgba(255, 255, 255, 0.7);
            padding: 1px 4px;
            border-radius: 3px;
            font-weight: normal;
        }
        
        .coordinates {
            position: absolute;
            bottom: 3px;
            right: 3px;
            font-size: 0.7rem;
            color: rgba(0, 0, 0, 0.7);
            background: rgba(255, 255, 255, 0.7);
            padding: 1px 4px;
            border-radius: 3px;
        }
        
        .box-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .no-results {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
        }
        
        .no-results i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: #e74c3c;
        }
        
        .boxes-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(500px, 1fr));
            gap: 30px;
            margin-top: 20px;
        }
        
        @media (max-width: 768px) {
            .boxes-container {
                grid-template-columns: 1fr;
            }
            
            .box-grid {
                grid-template-columns: repeat(6, 1fr);
                gap: 5px;
            }
            
            .cell {
                width: 55px;
                height: 55px;
                font-size: 0.8rem;
            }
            
            .search-container {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-btn {
                width: 100%;
                justify-content: center;
            }
            
            .result-info {
                flex-direction: column;
                align-items: stretch;
            }
            
            .info-item {
                min-width: 100%;
            }
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            color: #7f8c8d;
            font-size: 0.9rem;
            border-top: 1px solid #e0e6ed;
        }
        
        .color-info {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 10px;
        }
        
        .color-swatch {
            width: 30px;
            height: 30px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        
        .info-icon {
            font-size: 1.2rem;
            opacity: 0.7;
        }
        
        /* 为各个信息项添加不同的图标颜色 */
        .box-icon {
            color: #e74c3c;
        }
        
        .row-icon {
            color: #3498db;
        }
        
        .col-icon {
            color: #2ecc71;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-palette"></i> 拼豆色号查找工具</h1>
            <p class="subtitle">Mard264色 - 带颜色显示的色号查找工具</p>
        </header>
        
        <section class="search-section">
            <div class="search-container">
                <div class="search-input-wrapper">
                    <input type="text" class="search-input" id="colorInput" placeholder="输入拼豆色号，例如：C2, D16, M5..." autofocus>
                    <button class="clear-search" id="clearSearchBtn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <button class="search-btn" id="searchBtn">
                    <i class="fas fa-search"></i> 查找色号
                </button>
            </div>
            <p class="example">示例色号: 
                <span onclick="searchExample('C2')">C2</span>, 
                <span onclick="searchExample('D16')">D16</span>, 
                <span onclick="searchExample('M5')">M5</span>, 
                <span onclick="searchExample('F10')">F10</span>,
                <span onclick="searchExample('B10')">B10</span>
            </p>
        </section>
        
        <section class="history-section" id="historySection">
            <div class="history-header">
                <h3 class="history-title"><i class="fas fa-history"></i> 最近查询</h3>
                <button class="clear-history" id="clearHistoryBtn">
                    <i class="fas fa-trash-alt"></i> 清空历史
                </button>
            </div>
            <div class="history-items" id="historyItems">
                <!-- 历史记录将通过JS动态生成 -->
            </div>
        </section>
        
        <section class="results-section" id="resultsSection">
            <div class="results-header">
                <h2 class="result-title">查找结果：色号 <span class="result-color" id="resultColor">C2</span></h2>
                <div class="color-info">
                    <div class="color-swatch" id="colorSwatch"></div>
                    <span id="colorHex">#ABF8FE</span>
                </div>
                <button class="search-btn" id="resetBtn">
                    <i class="fas fa-redo"></i> 重新查找
                </button>
            </div>
            
            <!-- 精简后的结果信息区域（只显示盒子、行数、列数） -->
            <div class="result-info" id="resultInfo">
                <div class="info-item">
                    <div class="info-label">所在盒子</div>
                    <div class="info-value">
                        <i class="fas fa-box info-icon box-icon"></i>
                        <span id="infoBox">A</span>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-label">所在行数</div>
                    <div class="info-value">
                        <i class="fas fa-grip-lines-vertical info-icon row-icon"></i>
                        <span id="infoRow">1</span>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-label">所在列数</div>
                    <div class="info-value">
                        <i class="fas fa-grip-lines info-icon col-icon"></i>
                        <span id="infoCol">2</span>
                    </div>
                </div>
            </div>
            
            <!-- 颜色预览区域 -->
            <div class="color-preview" id="colorPreview"></div>
            
            <div class="visualization-section" id="visualization">
                <!-- 可视化内容将通过JS动态生成 -->
            </div>
        </section>
        
        <footer>
            <p>拼豆色号查找工具 &copy; 2023 | 数据来源：Mard264色拼豆套装</p>
        </footer>
    </div>

    <script>
        // 拼豆盒子数据
        const BOX_DATA = {
            // 盒子A
            'A': [
                ['B10', 'C2', 'C3', 'C13', 'D16', 'D17'],
                ['B6', 'C4', 'C10', 'C17', 'D1', 'D11'],
                ['C15', 'C11', 'C5', 'C6', 'C7', 'D2'],
                ['B19', 'B7', 'C8', 'C9', 'D3', 'C16']
            ],
            
            // 盒子B
            'B': [
                ['E12', 'E2', 'E8', 'D19', 'D8', 'D9'],
                ['E6', 'E4', 'E3', 'E9', 'D12', 'D6'],
                ['E5', 'E10', 'D5', 'D13', 'D20', 'D18'],
                ['E7', 'E13', 'D21', 'D14', 'D7', 'D15']
            ],
            
            // 盒子C
            'C': [
                ['C14', 'B20', 'C1', 'B18', 'M5', 'M6'],
                ['B3', 'B16', 'B13', 'B1', 'G13', 'F10'],
                ['B5', 'B4', 'B2', 'B14', 'G7', 'F11'],
                ['B15', 'B12', 'B8', 'B17', 'B11', 'G8']
            ],
            
            // 盒子D
            'D': [['A15','A3','A11','A9','F14','F12'],['A4','A13','A6','F1','F2','F3'],['A5','A10','A7','F13','F9','F6'],['A8','A14','F4','F5','F8','F7']],
            
            // 盒子E
            'E': [['E15','E1','E14','E11','H2','H1'],['A12','G3','G2','G1','A1','H12'],['G6','G5','G9','M9','H3','H4'],['G14','M12','G17','H5','H6','H7']],
            
            // 盒子6
            '6': [['H8','G15','A2','H13','G16','H9'],['H10','M1','G11','G4','M4','H14'],['M10','M2','G12','M13','M7','H11'],['M11','M3','G10','M14','M8','M15']],
            
            // 盒子7
            '7': [['P18','P16','P3','P12','P1','T1'],['P7','P17','P6','P13','P9','P11'],['P4','P5','P15','P14','P2','R12'],['P23','P22','P21','P20','P19','P8']],
            
            // 盒子8
            '8': [['P10','R11','Y2','Y3','Q2','Y4'],['Y5','Y1','R3','R4','R5','R8'],['R9','R2','R1','R10','R6','R7'],['D10','R13','Q5','B9','C12','D4']],
            
            // 盒子9
            '9': [['H17','H18','H19','E16','F16','F17'],['D23','E24','E19','E18','E17','E20'],['B23','A16','A17','A18','F24','F23'],['A24','A22','A21','F21','F22','A19']],
            
            // 盒子10
            '10': [['A26','A25','A20','A23','G18','H21'],['B26','B32','B31','B30','B27','B29'],['C22','C23','C24','B28','C25','C27'],['H15','H20','H23','H22','C28','C21']],
            
            // 盒子11
            '11': [['F15','F19','G20','E21','E22','D26'],['F25','F20','G19','F18','G21','E23'],['D25','D22','D24','C20','B21','B25'],['H16','B23','C18','B22','C19','C26']]
        };

        // 色号颜色数据（从Excel提取）
        const COLOR_DATA = {
            // A系列色号
            'A1': '#FAF5CD', 'A2': '#FCFED6', 'A3': '#FCFF92', 'A4': '#F7EC5C', 'A5': '#F0D83A',
            'A6': '#FDA951', 'A7': '#FA8C4F', 'A8': '#FBDA4D', 'A9': '#F79D5F', 'A10': '#F47E38',
            'A11': '#FEDB99', 'A12': '#FDA276', 'A13': '#FEC667', 'A14': '#F75842', 'A15': '#FBF65E',
            'A16': '#FEFF97', 'A17': '#FDE173', 'A18': '#FCBF80', 'A19': '#FD7E77', 'A20': '#F9D66E',
            'A21': '#FAE393', 'A22': '#EDF878', 'A23': '#E4C8BA', 'A24': '#F3F6A9', 'A25': '#FFD785',
            'A26': '#FFC734',
            
            // B系列色号
            'B1': '#DFF13B', 'B2': '#64F343', 'B3': '#A1F586', 'B4': '#5FDF34', 'B5': '#39E158',
            'B6': '#64E0A4', 'B7': '#3EAE7C', 'B8': '#1D9B54', 'B9': '#2A5037', 'B10': '#9AD1BA',
            'B11': '#627032', 'B12': '#1A6E3D', 'B13': '#C8E87D', 'B14': '#ABE84F', 'B15': '#305335',
            'B16': '#C0ED4F', 'B17': '#9EB33E', 'B18': '#E6ED4F', 'B19': '#26B78E', 'B20': '#CBECCF',
            'B21': '#18616A', 'B22': '#0A4241', 'B23': '#343B1A', 'B24': '#E8FAA6', 'B25': '#4E846D',
            'B26': '#907C35', 'B27': '#D0E0AF', 'B28': '#9EE5BB', 'B29': '#C6DF5F', 'B30': '#E3FBB1',
            'B31': '#B4E691', 'B32': '#92B060',
            
            // C系列色号
            'C1': '#F0FEE4', 'C2': '#ABF8FE', 'C3': '#1AE0F7', 'C4': '#44CDFB', 'C5': '#06AADF',
            'C6': '#54A7E9', 'C7': '#3977CA', 'C8': '#0F52BD', 'C9': '#3349C3', 'C10': '#3CBCE3',
            'C11': '#2ADED3', 'C12': '#1E334E', 'C13': '#CDE7FE', 'C14': '#D5FCF7', 'C15': '#21C5C4',
            'C16': '#1858A2', 'C17': '#02D1F3', 'C18': '#213244', 'C19': '#18869D', 'C20': '#1A70A9',
            'C21': '#BCDDFC', 'C22': '#6BB1BB', 'C23': '#C8E2FD', 'C24': '#7EC5F9', 'C25': '#A9E8E0',
            'C26': '#42ADCF', 'C27': '#D0DEF9', 'C28': '#BDCEE8', 'C29': '#364A89',
            
            // D系列色号
            'D1': '#ACB7EF', 'D2': '#868DD3', 'D3': '#3554AF', 'D4': '#162D7B', 'D5': '#B34EC6',
            'D6': '#B37BDC', 'D7': '#8758A9', 'D8': '#E3D2FE', 'D9': '#D5B9F4', 'D10': '#301A49',
            'D11': '#BEB9E2', 'D12': '#DC99CE', 'D13': '#B5038D', 'D14': '#862993', 'D15': '#2F1F8C',
            'D16': '#E2E4F0', 'D17': '#C7D3F9', 'D18': '#9A64B8', 'D19': '#D8C2D9', 'D20': '#9A35AD',
            'D21': '#940595', 'D22': '#38389A', 'D23': '#EADBF8', 'D24': '#768AE1', 'D25': '#4950C2',
            'D26': '#D6C6EB',
            
            // E系列色号
            'E1': '#F6D4CB', 'E2': '#FCC1DD', 'E3': '#F6BDE8', 'E4': '#E8649E', 'E5': '#F0569F',
            'E6': '#EB4172', 'E7': '#C53674', 'E8': '#FDDBE9', 'E9': '#E376C7', 'E10': '#D13B95',
            'E11': '#F7DAD4', 'E12': '#F693BF', 'E13': '#B5016A', 'E14': '#FAD4BF', 'E15': '#F5C9CA',
            'E16': '#FBF4EC', 'E17': '#F7E3EC', 'E18': '#F9C8DB', 'E19': '#F6BBD1', 'E20': '#D7C6CE',
            'E21': '#C09DA4', 'E22': '#B38C9F', 'E23': '#937D8A', 'E24': '#DEBEE5',
            
            // F系列色号
            'F1': '#FE9381', 'F2': '#F63D4B', 'F3': '#EE4E3E', 'F4': '#FB2A40', 'F5': '#E10328',
            'F6': '#913635', 'F7': '#911932', 'F8': '#BB0126', 'F9': '#E0677A', 'F10': '#874628',
            'F11': '#592323', 'F12': '#F3536B', 'F13': '#F45C45', 'F14': '#FCADB2', 'F15': '#D50527',
            'F16': '#F8C0A9', 'F17': '#E89B7D', 'F18': '#D07F4A', 'F19': '#BE454A', 'F20': '#C69495',
            'F21': '#F2B8C6', 'F22': '#F7C3D0', 'F23': '#ED806C', 'F24': '#E09DAF', 'F25': '#E84854',
            
            // G系列色号
            'G1': '#FFE4D3', 'G2': '#FCC6AC', 'G3': '#F1C4A5', 'G4': '#DCB387', 'G5': '#E7B34E',
            'G6': '#E3A014', 'G7': '#985C3A', 'G8': '#713D2F', 'G9': '#E4B685', 'G10': '#DA8C42',
            'G11': '#DAC898', 'G12': '#FEC993', 'G13': '#B2714B', 'G14': '#8B684C', 'G15': '#F6F8E3',
            'G16': '#F2D8C1', 'G17': '#77544E', 'G18': '#FFE3D5', 'G19': '#DD7D41', 'G20': '#A5452F',
            'G21': '#B38561',
            
            // H系列色号
            'H1': '#FFFFFF', 'H2': '#FBFBFB', 'H3': '#B4B4B4', 'H4': '#878787', 'H5': '#464648',
            'H6': '#2C2C2C', 'H7': '#010101', 'H8': '#E7D6DC', 'H9': '#EFEDEE', 'H10': '#EBEBEB',
            'H11': '#CDCDCD', 'H12': '#FDF6EE', 'H13': '#F4EFD1', 'H14': '#CED7D4', 'H15': '#9AA6A6',
            'H16': '#1B1213', 'H17': '#F0EEEF', 'H18': '#FCFFF6', 'H19': '#F2EEE5', 'H20': '#96A09F',
            'H21': '#F8FBE6', 'H22': '#CACAD2', 'H23': '#9B9C94',
            
            // M系列色号
            'M1': '#BBC6B6', 'M2': '#909994', 'M3': '#697E80', 'M4': '#E0D4BC', 'M5': '#D1CCAF',
            'M6': '#B0AA86', 'M7': '#B0A796', 'M8': '#AE7F82', 'M9': '#A68862', 'M10': '#C4B3BB',
            'M11': '#9E7592', 'M12': '#644A51', 'M13': '#C79266', 'M14': '#C27464', 'M15': '#747D7A'
        };

        // DOM元素
        const colorInput = document.getElementById('colorInput');
        const clearSearchBtn = document.getElementById('clearSearchBtn');
        const searchBtn = document.getElementById('searchBtn');
        const resetBtn = document.getElementById('resetBtn');
        const historySection = document.getElementById('historySection');
        const historyItems = document.getElementById('historyItems');
        const clearHistoryBtn = document.getElementById('clearHistoryBtn');
        const resultsSection = document.getElementById('resultsSection');
        const resultColor = document.getElementById('resultColor');
        const colorSwatch = document.getElementById('colorSwatch');
        const colorHex = document.getElementById('colorHex');
        const colorPreview = document.getElementById('colorPreview');
        const infoBox = document.getElementById('infoBox');
        const infoRow = document.getElementById('infoRow');
        const infoCol = document.getElementById('infoCol');
        const visualization = document.getElementById('visualization');

        // 历史记录管理
        const HISTORY_KEY = 'beadColorSearchHistory';
        let searchHistory = [];
        
        // 初始化历史记录
        function initHistory() {
            const savedHistory = localStorage.getItem(HISTORY_KEY);
            if (savedHistory) {
                try {
                    searchHistory = JSON.parse(savedHistory);
                    updateHistoryDisplay();
                    if (searchHistory.length > 0) {
                        historySection.style.display = 'block';
                    }
                } catch (e) {
                    console.error('加载历史记录失败:', e);
                    searchHistory = [];
                }
            }
        }
        
        // 保存历史记录
        function saveHistory(color, result) {
            // 移除重复项
            searchHistory = searchHistory.filter(item => item.color !== color);
            
            // 添加到历史记录开头
            searchHistory.unshift({
                color: color,
                hex: result?.hex || COLOR_DATA[color] || '#CCCCCC',
                timestamp: new Date().getTime(),
                result: result ? {
                    box: result.box,
                    row: result.row,
                    col: result.col
                } : null
            });
            
            // 只保留最近10条
            if (searchHistory.length > 10) {
                searchHistory = searchHistory.slice(0, 10);
            }
            
            // 保存到本地存储
            localStorage.setItem(HISTORY_KEY, JSON.stringify(searchHistory));
            
            // 更新显示
            updateHistoryDisplay();
            historySection.style.display = 'block';
        }
        
        // 更新历史记录显示
        function updateHistoryDisplay() {
            historyItems.innerHTML = '';
            
            if (searchHistory.length === 0) {
                historyItems.innerHTML = '<div style="color: #7f8c8d; font-style: italic;">暂无查询历史</div>';
                return;
            }
            
            searchHistory.forEach(item => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.innerHTML = `
                    <div class="history-color" style="background-color: ${item.hex}"></div>
                    ${item.color}
                `;
                historyItem.addEventListener('click', () => {
                    colorInput.value = item.color;
                    displayResult(item.color);
                    updateClearButton();
                });
                historyItems.appendChild(historyItem);
            });
        }
        
        // 清空历史记录
        function clearHistory() {
            if (confirm('确定要清空所有查询历史吗？')) {
                searchHistory = [];
                localStorage.removeItem(HISTORY_KEY);
                updateHistoryDisplay();
                historySection.style.display = 'none';
            }
        }
        
        // 更新清除按钮显示
        function updateClearButton() {
            if (colorInput.value.trim() !== '') {
                clearSearchBtn.style.display = 'block';
            } else {
                clearSearchBtn.style.display = 'none';
            }
        }
        
        // 清除搜索框内容
        function clearSearch() {
            colorInput.value = '';
            colorInput.focus();
            updateClearButton();
            // 清空搜索框时显示所有盒子
            showAllBoxesInOrder();
            resultsSection.style.display = 'none';
        }
        
        // 查找色号函数
        function findColor(color) {
            const normalizedColor = color.trim().toUpperCase();
            let result = null;
            
            // 遍历所有盒子
            for (const boxName in BOX_DATA) {
                const box = BOX_DATA[boxName];
                
                // 遍历盒子的每一行
                for (let row = 0; row < box.length; row++) {
                    const currentRow = box[row];
                    
                    // 遍历当前行的每一列
                    for (let col = 0; col < currentRow.length; col++) {
                        if (currentRow[col] === normalizedColor) {
                            result = {
                                box: boxName,
                                row: row + 1, // 转换为1起始的索引
                                col: col + 1, // 转换为1起始的索引
                                color: normalizedColor,
                                hex: COLOR_DATA[normalizedColor] || '#CCCCCC'
                            };
                            break;
                        }
                    }
                    if (result) break;
                }
                if (result) break;
            }
            
            return result;
        }

        // 根据颜色代码确定文字颜色（确保对比度）
        function getContrastColor(hexColor) {
            // 如果是无效颜色，返回黑色
            if (!hexColor || hexColor === '#CCCCCC') return '#333333';
            
            // 去掉#号
            const hex = hexColor.replace('#', '');
            
            // 转换为RGB
            const r = parseInt(hex.substring(0, 2), 16);
            const g = parseInt(hex.substring(2, 4), 16);
            const b = parseInt(hex.substring(4, 6), 16);
            
            // 计算亮度（YIQ公式）
            const brightness = (r * 299 + g * 587 + b * 114) / 1000;
            
            // 根据亮度返回黑色或白色
            return brightness > 128 ? '#333333' : '#FFFFFF';
        }

        // 创建盒子可视化（移除了行标签和列标签）
        function createBoxVisualization(boxName, targetColor, targetRow, targetCol, highlightOnlyTarget = false) {
            const boxData = BOX_DATA[boxName];
            const boxWrapper = document.createElement('div');
            boxWrapper.className = 'box-wrapper';
            
            // 创建盒子标题
            const boxTitle = document.createElement('div');
            boxTitle.className = 'box-title';
            boxTitle.textContent = `盒子 ${boxName}`;
            boxWrapper.appendChild(boxTitle);
            
            // 创建网格（移除了行标签和列标签）
            const boxGrid = document.createElement('div');
            boxGrid.className = 'box-grid';
            
            // 填充网格
            for (let r = 0; r < 4; r++) {
                for (let c = 0; c < 6; c++) {
                    const cell = document.createElement('div');
                    const colorCode = boxData[r] && boxData[r][c] ? boxData[r][c] : '';
                    
                    if (colorCode) {
                        cell.className = 'cell filled-cell';
                        cell.textContent = colorCode;
                        
                        // 获取颜色
                        const hexColor = COLOR_DATA[colorCode] || '#CCCCCC';
                        cell.style.backgroundColor = hexColor;
                        cell.style.color = getContrastColor(hexColor);
                        
                        // 添加HEX值
                        const hexSpan = document.createElement('div');
                        hexSpan.className = 'cell-hex';
                        hexSpan.textContent = hexColor;
                        hexSpan.style.color = getContrastColor(hexColor);
                        cell.appendChild(hexSpan);
                        
                        // 如果是目标色号，添加特殊样式
                        if (targetColor && targetColor === colorCode && targetRow === r+1 && targetCol === c+1) {
                            cell.classList.add('target-cell');
                        }
                    } else {
                        cell.className = 'cell empty-cell';
                        cell.textContent = '空';
                    }
                    
                    // 添加坐标信息（保留坐标信息但可以隐藏）
                    const coord = document.createElement('div');
                    coord.className = 'coordinates';
                    coord.textContent = `${r+1},${c+1}`;
                    cell.appendChild(coord);
                    
                    boxGrid.appendChild(cell);
                }
            }
            
            boxWrapper.appendChild(boxGrid);
            return boxWrapper;
        }

        // 按顺序显示所有盒子
        function showAllBoxesInOrder() {
            visualization.innerHTML = '';
            resultsSection.style.display = 'block';
            
            // 更新结果标题为显示所有盒子
            resultColor.textContent = '所有盒子';
            infoBox.textContent = '全部';
            infoRow.textContent = '--';
            infoCol.textContent = '--';
            
            // 重置颜色显示
            colorSwatch.style.backgroundColor = '#FFFFFF';
            colorHex.textContent = '所有颜色';
            colorPreview.style.backgroundColor = '#F5F7FA';
            colorPreview.textContent = '显示所有盒子';
            colorPreview.style.color = '#333333';
            
            // 创建所有盒子的可视化
            const boxesContainer = document.createElement('div');
            boxesContainer.className = 'boxes-container';
            
            // 按照A-E, 6-11的顺序显示盒子
            const boxOrder = ['A', 'B', 'C', 'D', 'E', '6', '7', '8', '9', '10', '11'];
            
            boxOrder.forEach(boxName => {
                if (BOX_DATA[boxName]) {
                    const boxViz = createBoxVisualization(boxName);
                    boxesContainer.appendChild(boxViz);
                }
            });
            
            visualization.appendChild(boxesContainer);
            
            // 滚动到结果区域
            resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // 显示指定盒子的可视化
        function showBoxesForResult(targetResult) {
            visualization.innerHTML = '';
            
            if (!targetResult) return;
            
            // 创建所有盒子的可视化
            const boxesContainer = document.createElement('div');
            boxesContainer.className = 'boxes-container';
            
            // 只显示目标盒子
            const boxViz = createBoxVisualization(
                targetResult.box, 
                targetResult.color,
                targetResult.row,
                targetResult.col,
                true
            );
            boxesContainer.appendChild(boxViz);
            
            visualization.appendChild(boxesContainer);
        }

        // 显示查找结果
        function displayResult(color) {
            const result = findColor(color);
            
            // 保存到历史记录
            saveHistory(color, result);
            
            if (result) {
                // 更新结果显示
                resultColor.textContent = color.toUpperCase();
                infoBox.textContent = result.box;
                infoRow.textContent = result.row;
                infoCol.textContent = result.col;
                
                // 更新颜色显示
                const hexColor = result.hex;
                colorSwatch.style.backgroundColor = hexColor;
                colorHex.textContent = hexColor;
                colorPreview.style.backgroundColor = hexColor;
                colorPreview.textContent = hexColor;
                colorPreview.style.color = getContrastColor(hexColor);
                
                // 显示目标盒子的可视化
                showBoxesForResult(result);
                
                // 显示结果区域
                resultsSection.style.display = 'block';
                
                // 滚动到结果区域
                resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            } else {
                // 没有找到色号
                visualization.innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-times-circle"></i>
                        <h3>未找到色号 "${color.toUpperCase()}"</h3>
                        <p>请检查拼豆色号是否正确，或尝试其他色号。</p>
                    </div>
                `;
                
                // 更新结果显示为未找到
                resultColor.textContent = color.toUpperCase();
                infoBox.textContent = '未找到';
                infoRow.textContent = '--';
                infoCol.textContent = '--';
                
                // 重置颜色显示
                colorSwatch.style.backgroundColor = '#CCCCCC';
                colorHex.textContent = '#CCCCCC';
                colorPreview.style.backgroundColor = '#CCCCCC';
                colorPreview.textContent = '未找到色号';
                colorPreview.style.color = '#333333';
                
                // 显示结果区域
                resultsSection.style.display = 'block';
                resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }
        
        // 示例搜索函数
        function searchExample(color) {
            colorInput.value = color;
            displayResult(color);
            updateClearButton();
        }

        // 事件监听器
        searchBtn.addEventListener('click', () => {
            const color = colorInput.value.trim();
            if (color) {
                displayResult(color);
            } else {
                // 搜索框为空时显示所有盒子
                showAllBoxesInOrder();
            }
        });

        colorInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                searchBtn.click();
            }
        });

        colorInput.addEventListener('input', updateClearButton);
        
        clearSearchBtn.addEventListener('click', clearSearch);
        
        resetBtn.addEventListener('click', () => {
            colorInput.value = '';
            colorInput.focus();
            updateClearButton();
            resultsSection.style.display = 'none';
        });

        clearHistoryBtn.addEventListener('click', clearHistory);

        // 页面加载时初始化
        window.addEventListener('load', () => {
            // 初始化历史记录
            initHistory();
            
            // 显示所有盒子
            showAllBoxesInOrder();
            
            // 设置输入框焦点
            colorInput.focus();
            
            // 初始更新清除按钮状态
            updateClearButton();
        });
    </script>
</body>
</html>
